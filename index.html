<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üß† Stavthon Interpreter v3.2 - Fully Documented</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      padding: 20px;
    }
    h1 {
      font-size: 24px;
      margin-bottom: 5px;
    }
    p.founder {
      color: #666;
      font-size: 14px;
      margin-bottom: 20px;
    }
    textarea {
      width: 100%;
      height: 200px;
      font-family: monospace;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      resize: vertical;
      margin-bottom: 10px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    pre {
      background: #272822;
      color: #f8f8f2;
      padding: 10px;
      white-space: pre-wrap;
    }
    .docs {
      margin-top: 30px;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      font-size: 15px;
    }
    .doc-section {
      margin-bottom: 25px;
    }
    .doc-section h3 {
      color: #333;
      margin-bottom: 10px;
      font-size: 1.2em;
    }
    code {
      display: block;
      background: #f1f1f1;
      padding: 10px;
      border-left: 4px solid #007bff;
      margin: 10px 0;
      font-family: monospace;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<h1>üß† Stavthon Interpreter v3.2</h1>
<p class="founder">Founded by Kaustav Ray</p>

<textarea id="codeInput">
# Variables with numbers
a = 50
b = 25
c = a * 2 + b / 5

# Variables with strings
firstName = "John"
lastName = "Doe"

# Mixed usage
fullName = firstName + " " + lastName

# More calculations
d = (a + b) * 3 - 10
e = d / 2 + c

# Print outputs
print(a)
print(b)
print(c)
print(d)
print(e)
print(fullName)

# Invalid variable to test error
print(not_defined_var)</textarea>

<button onclick="runStavthon()">Run Stavthon</button>

<h2>Output:</h2>
<pre id="output"></pre>

<div class="docs">
  <h3>üìú Language Rules</h3>

  <div class="doc-section">
    <h3>1. Variables</h3>
    <p>Syntax: name = value (no var, no let const nonsense)</p>
    <p><strong>Names</strong>: letters, numbers, underscores (start with letter/_)</p>
    <code>x = 42<br>user_name = Alice</code>
  </div>

  <div class="doc-section">
    <h3>2. Data Types</h3>
    <p><strong>Numbers</strong>: 10, 3.14</p>
    <p><strong>Strings</strong>: plain text (no quotes!)</p>
    <code>greeting = Hello World</code>
  </div>

  <div class="doc-section">
    <h3>3. Print</h3>
    <p>Syntax: print(variable_name)<br>Shows variable value</p>
  </div>

  <div class="doc-section">
    <h3>4. Comments</h3>
    <p>Lines starting with <code>#</code> are ignored</p>
    <code># chill bro this is a comment</code>
  </div>

  <div class="doc-section">
    <h3>5. Limitations</h3>
    <ul>
      <li>No loops</li>
      <li>No if-else</li>
      <li>Just simple bhaukaal vars & print</li>
    </ul>
    <p><strong>Variables stay alive line to line</strong> (persistent context)</p>
  </div>

  <h3>üß™ Sample Programs</h3>

  <div class="doc-section">
    <h3>Variables + Print</h3>
    <code>
x = 100<br>
y = 200<br>
print(x)<br>
print(y)
    </code>
  </div>

  <div class="doc-section">
    <h3>String Example</h3>
    <code>
welcome = Namaste Bhai<br>
user = Kaustav<br>
print(welcome)<br>
print(user)
    </code>
  </div>

  <div class="doc-section">
    <h3>Numbers & Strings Mixed</h3>
    <code>
name = Stavthon<br>
version = 1.0<br>
print(name)<br>
print(version)
    </code>
  </div>

  <h3>üìù Design Notes</h3>
  <ul>
    <li>Simple af syntax</li>
    <li>No eval() risky stuff</li>
    <li>Cool error msgs</li>
    <li>Variabes & strings handled smartly</li>
    <li>Single-pass interpreter</li>
    <li>Persistent vars</li>
    <li>Perfect for teaching basics</li>
  </ul>
</div>

<script>
function runStavthon() {
  const code = document.getElementById('codeInput').value;
  const output = document.getElementById('output');
  output.textContent = '';

  const vars = {};

  function log(msg) {
    output.textContent += msg + '\n';
  }

  const lines = code.split('\n');

  for (let line of lines) {
    line = line.trim();
    if (!line || line.startsWith('#')) continue;

    // Handle print statement
    if (line.startsWith('print(') && line.endsWith(')')) {
      const varName = line.slice(6, -1).trim();
      if (vars.hasOwnProperty(varName)) {
        log(vars[varName]);
      } else {
        log(`<<Undefined: ${varName}>>`);
      }
      continue;
    }

    // Handle variable assignment
    if (line.includes('=')) {
      const [name, expr] = line.split('=').map(part => part.trim());

      if (!/^[a-zA-Z_][a-zA-Z0-9_]*$/.test(name)) {
        log(`SyntaxError: Invalid variable name "${name}"`);
        continue;
      }

      // If it's a quoted string, store directly
      if (/^".*"$|^'.*'$/.test(expr)) {
        vars[name] = expr.slice(1, -1); // Remove quotes
        continue;
      }

      // Replace known variables in expression
      let evaluatedExpr = expr.replace(/([a-zA-Z_][a-zA-Z0-9_]*)/g, (_, match) => {
        if (vars.hasOwnProperty(match)) {
          const val = vars[match];
          return typeof val === 'string' ? `"${val}"` : val;
        }
        return `'undefined'`;
      });

      try {
        // Evaluate using Function
        const result = Function('"use strict"; return (' + evaluatedExpr + ')')();

        if (result === 'undefined') {
          log(`Error: Undefined variable used in "${line}"`);
        } else {
          vars[name] = result;
        }
      } catch (e) {
        // Fallback: treat as raw string
        vars[name] = expr;
      }

      continue;
    }

    log(`SyntaxError: Unknown command "${line}"`);
  }
}
</script>

</body>
</html>
